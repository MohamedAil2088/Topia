import{a8 as D,r as d,j as e,am as A,af as $,S as T,z as w,L as P,ad as I,an as k,ao as G}from"./react-vendor-fdd07533.js";import{L,a as O}from"./index-f5a8800a.js";import{av as z,aw as _,aB as M,aC as R}from"./vendor-28c12e7b.js";const Y=()=>{var o,x,h,p,m,g,f;const{id:n}=D(),[t,F]=d.useState(null),[E,c]=d.useState(!0),S=async()=>{var s,r;try{const{data:a}=await O.get(`/orders/${n}`);F(a.data||a),c(!1)}catch(a){console.error(a),_.fire({icon:"error",title:"Error",text:((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to load order"}),c(!1)}},C=()=>{var b,j,u,y,v,N;const s=new M;s.setFontSize(22),s.setTextColor(40),s.text("TOPIA E-COMMERCE",105,20,{align:"center"}),s.setFontSize(10),s.setTextColor(100),s.text("Cairo, Egypt | support@topia.com | +20 123 456 789",105,28,{align:"center"}),s.setLineWidth(.5),s.line(20,35,190,35),s.setFontSize(12),s.setTextColor(0),s.text(`INVOICE: #${(b=t._id)==null?void 0:b.slice(-8).toUpperCase()}`,20,45),s.text(`Date: ${new Date(t.createdAt).toLocaleDateString()}`,190,45,{align:"right"}),s.setFontSize(10),s.text("Bill To:",20,55),s.setFont("helvetica","bold"),s.text(((j=t.user)==null?void 0:j.name)||"Customer",20,60),s.setFont("helvetica","normal"),s.text(((u=t.shippingAddress)==null?void 0:u.address)||"",20,65),s.text(`${(y=t.shippingAddress)==null?void 0:y.city}, ${(v=t.shippingAddress)==null?void 0:v.country}`,20,70);const r=t.orderItems.map(i=>[i.name,i.qty,`${i.price.toFixed(2)} EGP`,`${(i.qty*i.price).toFixed(2)} EGP`]);R(s,{startY:80,head:[["Product","Qty","Unit Price","Total"]],body:r,theme:"striped",headStyles:{fillColor:[17,24,39]}});const a=s.lastAutoTable.finalY+10;s.text(`Subtotal: ${t.itemsPrice.toFixed(2)} EGP`,190,a,{align:"right"}),s.text(`Shipping: ${t.shippingPrice.toFixed(2)} EGP`,190,a+5,{align:"right"}),s.setFontSize(14),s.setFont("helvetica","bold"),s.text(`TOTAL: ${t.totalPrice.toFixed(2)} EGP`,190,a+15,{align:"right"}),s.save(`Topia_Invoice_${(N=t._id)==null?void 0:N.slice(-8).toUpperCase()}.pdf`)};if(d.useEffect(()=>{S()},[n]),E)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(L,{size:"lg"})});if(!t)return e.jsx("div",{className:"text-center p-10",children:"Order not found"});const l=[{status:"Processing",icon:A,active:!0},{status:"Confirmed",icon:$,active:t.isPaid},{status:"Shipped",icon:T,active:t.isShipped||t.isDelivered},{status:"Delivered",icon:w,active:t.isDelivered}];return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-5xl pt-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(P,{to:"/profile/orders",className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(I,{size:24})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold font-display flex items-center gap-3",children:["Order #",t._id.substring(0,8),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${t.isDelivered?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.status||(t.isDelivered?"Delivered":"Processing")})]}),e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Placed on ",new Date(t.createdAt).toLocaleDateString()]})]})]}),e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-all font-bold text-sm shadow-lg shadow-gray-200",children:[e.jsx(k,{})," Invoice"]})]}),e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-10 md:p-14 mb-12 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gray-50",children:e.jsx(z.div,{initial:{width:0},animate:{width:`${l.filter(s=>s.active).length/l.length*100}%`},transition:{duration:1.5,ease:"circOut"},className:"h-full bg-primary-900 shadow-[0_0_20px_rgba(15,23,42,0.5)]"})}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-12 relative",children:l.map((s,r)=>e.jsxs("div",{className:"flex flex-row md:flex-col items-center gap-6 md:gap-4 flex-1",children:[e.jsxs("div",{className:`w-16 h-16 rounded-[1.5rem] flex items-center justify-center transition-all duration-500 relative ${s.active?"bg-primary-900 text-white shadow-2xl shadow-primary-900/40 rotate-12 scale-110":"bg-gray-50 text-gray-300 border border-gray-100"}`,children:[e.jsx(s.icon,{size:28}),s.active&&e.jsxs("span",{className:"absolute -top-1 -right-1 flex h-4 w-4",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-accent-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-accent-500"})]})]}),e.jsxs("div",{className:"text-left md:text-center",children:[e.jsx("span",{className:`block text-xs font-black uppercase tracking-[0.2em] mb-1 ${s.active?"text-primary-950":"text-gray-400"}`,children:s.status}),s.active?e.jsx("p",{className:"text-[10px] text-accent-600 font-bold italic",children:"Status Locked"}):e.jsx("p",{className:"text-[10px] text-gray-300 font-medium",children:"Pending Logic"})]})]},r))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-50 bg-gray-50/50",children:e.jsx("h2",{className:"font-bold text-gray-900",children:"Order Items"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:t.orderItems.map(s=>e.jsxs("div",{className:"p-6 flex gap-4 items-center",children:[e.jsx("div",{className:"w-20 h-24 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-200",children:e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx(P,{to:`/product/${s.product}`,className:"font-bold text-gray-900 hover:text-primary-600 transition-colors block mb-1",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:[s.size," / ",s.color]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsxs("span",{children:[s.price," EGP"]}),e.jsx("span",{className:"text-gray-400",children:"Ã—"}),e.jsx("span",{children:s.qty})]})]}),e.jsxs("div",{className:"text-right font-bold text-lg",children:[(s.price*s.qty).toFixed(2)," EGP"]})]},s._id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h2",{className:"font-bold text-gray-900 mb-4",children:"Summary"}),e.jsxs("div",{className:"space-y-3 pb-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:[((o=t.itemsPrice)==null?void 0:o.toFixed(2))||"0.00"," EGP"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Shipping"}),e.jsxs("span",{children:[((x=t.shippingPrice)==null?void 0:x.toFixed(2))||"0.00"," EGP"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Tax"}),e.jsxs("span",{children:[((h=t.taxPrice)==null?void 0:h.toFixed(2))||"0.00"," EGP"]})]}),t.discountPrice>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-",((p=t.discountPrice)==null?void 0:p.toFixed(2))||"0.00"," EGP"]})]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 pt-4",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[(m=t.totalPrice)==null?void 0:m.toFixed(2)," EGP"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("h2",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(w,{className:"text-gray-400"})," Shipping Address"]}),e.jsxs("div",{className:"text-gray-600 text-sm leading-relaxed",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-1",children:(g=t.user)==null?void 0:g.name}),e.jsx("p",{children:t.shippingAddress.address}),e.jsxs("p",{children:[t.shippingAddress.city,", ",t.shippingAddress.postalCode]}),e.jsx("p",{children:t.shippingAddress.country})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("h2",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"text-gray-400"})," Payment Info"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.paymentMethod}),t.isPaid?e.jsx("span",{className:"text-xs font-bold text-green-700 bg-green-100 px-2 py-1 rounded",children:"PAID"}):e.jsx("span",{className:"text-xs font-bold text-yellow-700 bg-yellow-100 px-2 py-1 rounded",children:"UNPAID"})]}),t.paymentMethod==="Vodafone Cash"&&((f=t.paymentResult)==null?void 0:f.id)&&e.jsxs("div",{className:"text-xs text-gray-500 break-all p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"font-bold",children:"Transaction ID:"})," ",t.paymentResult.id]})]})]})]})]})]})};export{Y as default};
