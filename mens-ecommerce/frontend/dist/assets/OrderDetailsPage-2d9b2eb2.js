import{a8 as ae,r as h,j as e,al as H,L as V,ad as re,an as le,a1 as ie,aj as u,S as b,af as c,n as J,B as de,C as ne,aq as ce,ao as oe,am as xe,ai as me}from"./react-vendor-f6cd2f28.js";import{B as f}from"./Button-85468c44.js";import{L as he,a as p}from"./index-93e771d7.js";import{aw as d,aB as pe,aC as ge}from"./vendor-662f24ba.js";const j=me(d),Ne=()=>{var N,v,w,P,k,S,C,F,z,D,A,E,I,$,T,B,O,L,M,R,G;const{id:l}=ae(),[s,K]=h.useState(null),[X,y]=h.useState(!0),[g,n]=h.useState(!1),m=async()=>{var t,r;try{const{data:a}=await p.get(`/orders/${l}`);K(a.data||a),y(!1)}catch(a){console.error(a),d.fire({icon:"error",title:"Error",text:((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to load order"}),y(!1)}};h.useEffect(()=>{m()},[l]);const Z=async()=>{var r,a;if((await j.fire({title:"Mark as Paid?",text:"Are you sure you want to mark this order as paid?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, Mark Paid",confirmButtonColor:"#10B981"})).isConfirmed){n(!0);try{await p.put(`/orders/${l}/pay`),await m(),d.fire("Success","Order marked as paid","success")}catch(i){d.fire("Error",((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.message)||"Update failed","error")}finally{n(!1)}}},ee=async()=>{var r,a;if((await j.fire({title:"Mark as Shipped?",text:"Are you sure you want to mark this order as shipped?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, Mark Shipped",confirmButtonColor:"#F59E0B"})).isConfirmed){n(!0);try{await p.put(`/orders/${l}/ship`),await m(),d.fire("Success","Order marked as shipped ðŸšš","success")}catch(i){d.fire("Error",((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.message)||"Update failed","error")}finally{n(!1)}}},se=async()=>{var r,a;if((await j.fire({title:"Mark as Delivered?",text:"Are you sure you want to mark this order as delivered?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, Mark Delivered",confirmButtonColor:"#3B82F6"})).isConfirmed){n(!0);try{await p.put(`/orders/${l}/deliver`),await m(),d.fire("Success","Order marked as delivered âœ…","success")}catch(i){d.fire("Error",((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.message)||"Update failed","error")}finally{n(!1)}}},te=()=>{var i,U,q,Y,W,_,Q;const t=new pe;t.setFontSize(22),t.setTextColor(40),t.text("TOPIA E-COMMERCE",105,20,{align:"center"}),t.setFontSize(10),t.setTextColor(100),t.text("Cairo, Egypt | support@topia.com | +20 123 456 789",105,28,{align:"center"}),t.setLineWidth(.5),t.line(20,35,190,35),t.setFontSize(12),t.setTextColor(0),t.text(`INVOICE: #${(i=s._id||l)==null?void 0:i.slice(-8).toUpperCase()}`,20,45),t.text(`Date: ${new Date(s.createdAt).toLocaleDateString()}`,190,45,{align:"right"}),t.setFontSize(10),t.text("Bill To:",20,55),t.setFont("helvetica","bold"),t.text(((U=s.user)==null?void 0:U.name)||((q=s.guestInfo)==null?void 0:q.name)||"Customer",20,60),t.setFont("helvetica","normal"),t.text(((Y=s.shippingAddress)==null?void 0:Y.address)||"",20,65),t.text(`${(W=s.shippingAddress)==null?void 0:W.city}, ${(_=s.shippingAddress)==null?void 0:_.country}`,20,70);const r=s.orderItems.map(x=>[x.name,x.qty,`${x.price.toFixed(2)} EGP`,`${(x.qty*x.price).toFixed(2)} EGP`]);ge(t,{startY:80,head:[["Product","Qty","Unit Price","Total"]],body:r,theme:"striped",headStyles:{fillColor:[79,70,229]}});const a=t.lastAutoTable.finalY+10;t.text(`Subtotal: ${s.itemsPrice.toFixed(2)} EGP`,190,a,{align:"right"}),t.text(`Shipping: ${s.shippingPrice.toFixed(2)} EGP`,190,a+5,{align:"right"}),t.setFontSize(14),t.setFont("helvetica","bold"),t.text(`TOTAL: ${s.totalPrice.toFixed(2)} EGP`,190,a+15,{align:"right"}),t.setFontSize(10),t.setFont("helvetica","italic"),t.text("Thank you for shopping with TOPIA!",105,a+30,{align:"center"}),t.save(`Invoice_${(Q=s._id||l)==null?void 0:Q.slice(-8).toUpperCase()}.pdf`)};if(X)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(he,{size:"lg"})});if(!s)return e.jsxs("div",{className:"p-12 text-center bg-white rounded-2xl border border-gray-100",children:[e.jsx(H,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Order not found"}),e.jsx(V,{to:"/admin/orders",className:"text-primary-600 font-bold hover:underline",children:"Back to Orders"})]});const o=(()=>s.isDelivered?{label:"Delivered",color:"green",icon:c}:s.isShipped?{label:"Shipped",color:"purple",icon:b}:s.isPaid?{label:"Processing",color:"blue",icon:u}:{label:"Pending",color:"yellow",icon:u})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{to:"/admin/orders",className:"p-3 bg-gray-100 hover:bg-gray-200 rounded-xl transition-all transform hover:scale-105",children:e.jsx(re,{size:20})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black text-gray-900 flex items-center gap-3",children:["Order #",(N=s._id||l)==null?void 0:N.slice(-8).toUpperCase(),e.jsxs("span",{className:`px-4 py-2 rounded-xl text-sm font-black bg-${o.color}-100 text-${o.color}-700 border-2 border-${o.color}-200 flex items-center gap-2`,children:[e.jsx(o.icon,{size:16}),o.label]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Placed on ",new Date(s.createdAt).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsxs("button",{onClick:te,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:[e.jsx(le,{size:20})," Download Invoice"]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute top-5 left-0 right-0 h-1 bg-gray-200",children:e.jsx("div",{className:`h-full transition-all ${s.isDelivered?"w-full bg-green-500":s.isShipped?"w-2/3 bg-blue-500":s.isPaid?"w-1/3 bg-yellow-500":"w-0"}`})}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center z-10 ${s.isPaid?"bg-green-500 text-white":"bg-yellow-500 text-white"}`,children:s.isPaid?e.jsx(ie,{size:20}):e.jsx(u,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-gray-700 mt-2 text-center",children:s.isPaid?"Paid":"Pending"})]}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center z-10 ${s.isShipped?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:e.jsx(b,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-gray-700 mt-2 text-center",children:"Shipped"})]}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center z-10 ${s.isDelivered?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:e.jsx(c,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-gray-700 mt-2 text-center",children:"Delivered"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 p-3 rounded-xl",children:e.jsx(J,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Customer Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Contact and shipping details"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:e.jsx(J,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Full Name"}),e.jsx("p",{className:"font-black text-gray-900",children:((v=s.user)==null?void 0:v.name)||((w=s.guestInfo)==null?void 0:w.name)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:e.jsx(de,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Email Address"}),e.jsx("a",{href:`mailto:${((P=s.user)==null?void 0:P.email)||((k=s.guestInfo)==null?void 0:k.email)}`,className:"font-bold text-blue-600 hover:underline",children:((S=s.user)==null?void 0:S.email)||((C=s.guestInfo)==null?void 0:C.email)})]})]}),((F=s.shippingAddress)==null?void 0:F.phone)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:e.jsx(ne,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Phone Number"}),e.jsx("p",{className:"font-black text-gray-900",children:s.shippingAddress.phone})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:e.jsx(ce,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold mb-2",children:"Shipping Address"}),e.jsxs("div",{className:"text-sm text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"font-bold",children:(z=s.shippingAddress)==null?void 0:z.address}),e.jsxs("p",{children:[(D=s.shippingAddress)==null?void 0:D.city,", ",(A=s.shippingAddress)==null?void 0:A.postalCode]}),e.jsx("p",{children:(E=s.shippingAddress)==null?void 0:E.country})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"bg-green-100 text-green-600 p-3 rounded-xl",children:e.jsx(oe,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Payment Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Transaction details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-xl",children:[e.jsx("span",{className:"font-bold text-gray-700",children:"Payment Method"}),e.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg font-black",children:s.paymentMethod})]}),e.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-xl ${s.isPaid?"bg-green-50 border-2 border-green-200 text-green-700":"bg-red-50 border-2 border-red-200 text-red-700"}`,children:[s.isPaid?e.jsx(c,{size:24}):e.jsx(H,{size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-sm",children:s.isPaid?"Payment Received":"Payment Pending"}),s.isPaid&&e.jsxs("p",{className:"text-xs mt-1",children:["Paid on ",new Date(s.paidAt).toLocaleString()]})]})]}),s.paymentDetails&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsx("p",{className:"font-black text-blue-900 mb-3 text-sm",children:"Transaction Details:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.paymentDetails.walletNumber&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Wallet:"}),e.jsx("span",{className:"font-bold text-blue-900",children:s.paymentDetails.walletNumber})]}),(s.paymentDetails.transactionId||((I=s.paymentResult)==null?void 0:I.id))&&e.jsxs("p",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Trans ID:"}),e.jsx("code",{className:"font-mono font-bold text-blue-900 text-xs",children:s.paymentDetails.transactionId||(($=s.paymentResult)==null?void 0:$.id)})]})]})]}),((T=s.paymentResult)==null?void 0:T.receiptImage)&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("p",{className:"font-black text-gray-900 mb-3",children:"Payment Receipt:"}),e.jsx("a",{href:s.paymentResult.receiptImage,target:"_blank",rel:"noreferrer",className:"block border-2 border-gray-200 rounded-xl overflow-hidden hover:border-blue-500 transition-all",children:e.jsx("img",{src:s.paymentResult.receiptImage,alt:"Receipt",className:"w-full h-auto object-cover"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"bg-purple-100 text-purple-600 p-3 rounded-xl",children:e.jsx(xe,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Order Items"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(B=s.orderItems)==null?void 0:B.length," item(s)"]})]})]}),e.jsx("div",{className:"space-y-4",children:(O=s.orderItems)==null?void 0:O.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl border border-gray-200 hover:border-purple-300 transition-all",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-xl overflow-hidden border-2 border-gray-200 flex-shrink-0",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-black text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Qty: ",e.jsx("span",{className:"font-bold text-gray-900",children:t.qty})]}),e.jsx("span",{className:"text-gray-600",children:"Ã—"}),e.jsxs("span",{className:"text-gray-600",children:[t.price," EGP"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Subtotal"}),e.jsxs("p",{className:"text-xl font-black text-purple-600",children:[(t.qty*t.price).toFixed(2)," EGP"]})]})]},r))})]})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-24",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-3 border-b-2 border-gray-200 pb-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Items Price"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[(L=s.itemsPrice)==null?void 0:L.toFixed(2)," EGP"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[(M=s.shippingPrice)==null?void 0:M.toFixed(2)," EGP"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[((R=s.taxPrice)==null?void 0:R.toFixed(2))||"0.00"," EGP"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center text-xl font-black text-gray-900 mb-6 p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl border-2 border-purple-200",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-purple-600",children:[(G=s.totalPrice)==null?void 0:G.toFixed(2)," EGP"]})]}),e.jsxs("div",{className:"space-y-3",children:[!s.isPaid&&e.jsxs(f,{fullWidth:!0,onClick:Z,isLoading:g,className:"bg-green-600 hover:bg-green-700 text-white font-black py-4 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:[e.jsx(c,{className:"inline mr-2",size:20})," Mark as Paid"]}),!s.isShipped&&!s.isDelivered&&e.jsxs(f,{fullWidth:!0,onClick:ee,isLoading:g,className:"bg-blue-600 hover:bg-blue-700 text-white font-black py-4 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:[e.jsx(b,{className:"inline mr-2",size:20})," Mark as Shipped"]}),s.isShipped&&!s.isDelivered&&e.jsxs(f,{fullWidth:!0,onClick:se,isLoading:g,className:"bg-purple-600 hover:bg-purple-700 text-white font-black py-4 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:[e.jsx(c,{className:"inline mr-2",size:20})," Mark as Delivered"]}),s.isDelivered&&e.jsxs("div",{className:"text-center p-6 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl",children:[e.jsx(c,{className:"mx-auto text-green-600 mb-2",size:48}),e.jsx("p",{className:"text-green-700 font-black text-lg",children:"Order Completed! ðŸŽ‰"}),e.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["Delivered on ",new Date(s.deliveredAt).toLocaleDateString()]})]})]})]})})]})]})};export{Ne as default};
