import{r as a,j as e,as as O,a1 as q,s as U,aJ as B,aK as M,al as X,V as H,aL as J,aA as K,ac as W,aH as Y,ae as Q,ai as Z}from"./react-vendor-f6cd2f28.js";import{B as L}from"./Button-85468c44.js";import{I as x}from"./Input-b13869b6.js";import{L as $,a as j}from"./index-93e771d7.js";import{aw as c}from"./vendor-662f24ba.js";const ee=Z(c),ne=()=>{const[d,u]=a.useState([]),[G,f]=a.useState(!0),[N,v]=a.useState(""),[i,y]=a.useState(!1),[C,D]=a.useState(null),[w,E]=a.useState(""),[k,S]=a.useState(""),[o,F]=a.useState("percentage"),[g,z]=a.useState(""),[b,A]=a.useState(""),[h,T]=a.useState(""),P=async()=>{var s,t;f(!0),v("");try{const{data:n}=await j.get("/coupons");u(n.data||n)}catch(n){v(((t=(s=n.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load coupons"),console.error(n)}finally{f(!1)}};a.useEffect(()=>{P()},[]);const m=a.useMemo(()=>{const s=d.length,t=d.filter(r=>r.expiryDate&&new Date(r.expiryDate)<new Date?!1:r.isActive).length,n=d.filter(r=>r.expiryDate&&new Date(r.expiryDate)<new Date).length,l=d.filter(r=>r.discountType==="percentage").length;return{total:s,active:t,expired:n,percentage:l}},[d]),I=async s=>{var t,n;s.preventDefault(),y(!0);try{const l={code:w.trim().toUpperCase(),discount:Number(k),discountType:o};g&&(l.minOrderAmount=Number(g)),b&&o==="percentage"&&(l.maxDiscount=Number(b)),h&&(l.expiryDate=h);const{data:r}=await j.post("/coupons",l);u([...d,r.data||r]),E(""),S(""),F("percentage"),z(""),A(""),T(""),c.fire({icon:"success",title:"Coupon Created!",text:"The coupon code has been generated successfully.",timer:2e3,showConfirmButton:!1})}catch(l){c.fire("Error",((n=(t=l.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to create coupon","error"),console.error(l)}finally{y(!1)}},R=async(s,t)=>{var l,r;if((await ee.fire({title:`Delete Coupon "${t}"?`,text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed){D(s);try{await j.delete(`/coupons/${s}`),u(d.filter(p=>p._id!==s)),c.fire("Deleted!","Coupon has been deleted.","success")}catch(p){c.fire("Error",((r=(l=p.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to delete coupon","error"),console.error(p)}finally{D(null)}}},_=s=>{navigator.clipboard.writeText(s),c.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire({icon:"success",title:"Code copied to clipboard!"})},V=s=>s?new Date(s)<new Date:!1;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-1",children:"Coupons Management"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Create and manage discount coupons"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border-2 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-500 text-white p-3 rounded-lg",children:e.jsx(O,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-bold uppercase",children:"Total Coupons"}),e.jsx("p",{className:"text-3xl font-black text-blue-900",children:m.total})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border-2 border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-500 text-white p-3 rounded-lg",children:e.jsx(q,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-bold uppercase",children:"Active"}),e.jsx("p",{className:"text-3xl font-black text-green-900",children:m.active})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-4 border-2 border-red-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-500 text-white p-3 rounded-lg",children:e.jsx(U,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-bold uppercase",children:"Expired"}),e.jsx("p",{className:"text-3xl font-black text-red-900",children:m.expired})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border-2 border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-500 text-white p-3 rounded-lg",children:e.jsx(B,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-bold uppercase",children:"Percentage"}),e.jsx("p",{className:"text-3xl font-black text-purple-900",children:m.percentage})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-24",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"bg-green-100 text-green-600 p-3 rounded-xl",children:e.jsx(M,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Create Coupon"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Add new discount code"})]})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsx(x,{label:"Coupon Code",value:w,onChange:s=>E(s.target.value.toUpperCase()),placeholder:"e.g. SAVE20",required:!0,disabled:i}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Discount Type"}),e.jsxs("select",{className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-4 focus:ring-primary-100 focus:border-primary-900 outline-none font-bold text-gray-700",value:o,onChange:s=>F(s.target.value),disabled:i,children:[e.jsx("option",{value:"percentage",children:"ðŸ“Š Percentage (%)"}),e.jsx("option",{value:"fixed",children:"ðŸ’µ Fixed Amount (EGP)"})]})]}),e.jsx(x,{label:"Discount Value",type:"number",value:k,onChange:s=>S(s.target.value),placeholder:o==="percentage"?"10":"50",required:!0,disabled:i,min:"0",step:o==="percentage"?"1":"0.01"}),e.jsx(x,{label:"Min Order Amount (EGP) - Optional",type:"number",value:g,onChange:s=>z(s.target.value),placeholder:"100",disabled:i,min:"0"}),o==="percentage"&&e.jsx(x,{label:"Max Discount (EGP) - Optional",type:"number",value:b,onChange:s=>A(s.target.value),placeholder:"50",disabled:i,min:"0"}),e.jsx(x,{label:"Expiry Date - Optional",type:"date",value:h,onChange:s=>T(s.target.value),disabled:i}),e.jsxs(L,{type:"submit",fullWidth:!0,isLoading:i,className:"bg-green-600 hover:bg-green-700 font-black py-3",children:[e.jsx(M,{className:"inline mr-2"})," Create Coupon"]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:G?e.jsx("div",{className:"bg-white rounded-2xl p-12 flex justify-center border border-gray-100",children:e.jsx($,{size:"lg"})}):N?e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-2xl p-6 flex items-start gap-3",children:[e.jsx(X,{className:"text-red-500 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Error Loading Coupons"}),e.jsx("p",{className:"text-red-700 text-sm",children:N}),e.jsxs(L,{onClick:P,variant:"outline",className:"mt-3",children:[e.jsx(H,{className:"inline mr-2"})," Retry"]})]})]}):d.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(O,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No coupons created yet"})]}):e.jsx("div",{className:"space-y-4",children:d.map(s=>{const t=V(s.expiryDate);return e.jsx("div",{className:`bg-white rounded-2xl shadow-sm border-2 p-6 transition-all ${t?"border-red-200 opacity-60":"border-gray-100 hover:border-primary-300"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("code",{className:"text-2xl font-black bg-gradient-to-r from-primary-100 to-blue-100 text-primary-700 px-5 py-3 rounded-xl border-2 border-primary-200",children:s.code}),e.jsx("button",{onClick:()=>_(s.code),className:"p-3 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-xl transition-all transform hover:scale-110",title:"Copy code",children:e.jsx(J,{size:20})}),t&&e.jsx("span",{className:"px-3 py-1.5 bg-red-100 text-red-700 text-xs font-black rounded-xl border-2 border-red-200",children:"âŒ EXPIRED"}),!t&&e.jsx("span",{className:"px-3 py-1.5 bg-green-100 text-green-700 text-xs font-black rounded-xl border-2 border-green-200",children:"âœ… ACTIVE"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(B,{size:14,className:"text-blue-600"}),e.jsx("p",{className:"text-blue-600 text-xs font-bold",children:"Discount"})]}),e.jsx("p",{className:"font-black text-blue-900 text-lg",children:s.discountType==="percentage"?`${s.discount}%`:`${s.discount} EGP`})]}),s.minOrderAmount&&e.jsxs("div",{className:"bg-green-50 p-3 rounded-xl border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{size:14,className:"text-green-600"}),e.jsx("p",{className:"text-green-600 text-xs font-bold",children:"Min Order"})]}),e.jsxs("p",{className:"font-black text-green-900 text-lg",children:[s.minOrderAmount," EGP"]})]}),s.maxDiscount&&e.jsxs("div",{className:"bg-orange-50 p-3 rounded-xl border border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{size:14,className:"text-orange-600"}),e.jsx("p",{className:"text-orange-600 text-xs font-bold",children:"Max Discount"})]}),e.jsxs("p",{className:"font-black text-orange-900 text-lg",children:[s.maxDiscount," EGP"]})]}),s.expiryDate&&e.jsxs("div",{className:`p-3 rounded-xl border ${t?"bg-red-50 border-red-200":"bg-purple-50 border-purple-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{size:14,className:t?"text-red-600":"text-purple-600"}),e.jsx("p",{className:`text-xs font-bold ${t?"text-red-600":"text-purple-600"}`,children:"Expires"})]}),e.jsx("p",{className:`font-black text-lg ${t?"text-red-900":"text-purple-900"}`,children:new Date(s.expiryDate).toLocaleDateString()})]})]})]}),e.jsx("button",{onClick:()=>R(s._id,s.code),className:"ml-4 inline-flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 hover:bg-red-100 rounded-xl font-bold text-sm transition-all border-2 border-red-200 hover:border-red-300 hover:shadow-md transform hover:scale-105",disabled:C===s._id,title:"Delete coupon",children:C===s._id?e.jsx($,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:16})," Delete"]})})]})},s._id)})})})]})]})};export{ne as default};
