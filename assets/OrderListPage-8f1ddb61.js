import{r as o,j as e,o as N,aj as w,af as C,aA as U,_ as A,F as T,V as W,al as $,L as G,a5 as M}from"./react-vendor-f6cd2f28.js";import{L,a as k}from"./index-93e771d7.js";import{aw as P}from"./vendor-662f24ba.js";const H=()=>{const[l,f]=o.useState([]),[S,j]=o.useState(!0),[y,F]=o.useState(""),[p,z]=o.useState(""),[m,D]=o.useState("all"),[g,O]=o.useState("all"),[E,v]=o.useState(null),u=async()=>{var s,a;j(!0);try{const{data:r}=await k.get("/orders");console.log("Admin Orders Fetch Result:",r),f(r.data||r)}catch(r){F(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to load orders"),console.error(r)}finally{j(!1)}};o.useEffect(()=>{u()},[]);const R=async(s,a,r)=>{var i,d;v(s);try{let n="",x={};a==="delivered"?n=`/orders/${s}/deliver`:a==="shipped"?n=`/orders/${s}/ship`:(n=`/orders/${s}/status`,x={status:a}),await k.put(n,x),f(l.map(t=>t._id===s?{...t,status:a}:t)),P.fire({icon:"success",title:"Status Updated!",text:`Order status changed to ${a}`,timer:1500,showConfirmButton:!1})}catch(n){console.error("Update error:",n),P.fire("Error",((d=(i=n.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update status. Try viewing the order details to update status.","error")}finally{v(null)}},h=o.useMemo(()=>l.filter(s=>{var d,n,x,t;const a=s._id.toLowerCase().includes(p.toLowerCase())||((n=(d=s.user)==null?void 0:d.name)==null?void 0:n.toLowerCase().includes(p.toLowerCase()))||((t=(x=s.user)==null?void 0:x.email)==null?void 0:t.toLowerCase().includes(p.toLowerCase())),r=m==="all"||(s.status||(s.isDelivered?"delivered":"processing")).toLowerCase()===m.toLowerCase(),i=g==="all"||g==="paid"&&s.isPaid||g==="unpaid"&&!s.isPaid;return a&&r&&i}),[l,p,m,g]),c=o.useMemo(()=>{const s=l.length,a=l.filter(t=>(t.status||"pending").toLowerCase()==="pending").length,r=l.filter(t=>(t.status||"").toLowerCase()==="processing").length,i=l.filter(t=>(t.status||"").toLowerCase()==="delivered"||t.isDelivered).length,d=l.filter(t=>(t.status||"").toLowerCase()==="cancelled").length,n=l.filter(t=>t.isPaid).reduce((t,b)=>t+b.totalPrice,0),x=l.filter(t=>!t.isPaid).reduce((t,b)=>t+b.totalPrice,0);return{total:s,pending:a,processing:r,delivered:i,cancelled:d,totalRevenue:n,pendingRevenue:x}},[l]),_=s=>s?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-100 text-green-700 rounded-xl text-xs font-black border-2 border-green-200",children:[e.jsx(C,{size:14})," Paid"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-orange-100 text-orange-700 rounded-xl text-xs font-black border-2 border-orange-200",children:[e.jsx(w,{size:14})," Unpaid"]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-black font-display text-gray-900 mb-1",children:"Orders Management"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Monitor and manage all customer orders"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border-2 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-500 text-white p-3 rounded-lg",children:e.jsx(N,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-bold uppercase",children:"Total Orders"}),e.jsx("p",{className:"text-3xl font-black text-blue-900",children:c.total})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl p-4 border-2 border-yellow-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-yellow-500 text-white p-3 rounded-lg",children:e.jsx(w,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-yellow-600 font-bold uppercase",children:"Pending"}),e.jsx("p",{className:"text-3xl font-black text-yellow-900",children:c.pending})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border-2 border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-500 text-white p-3 rounded-lg",children:e.jsx(C,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-bold uppercase",children:"Delivered"}),e.jsx("p",{className:"text-3xl font-black text-green-900",children:c.delivered})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border-2 border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-500 text-white p-3 rounded-lg",children:e.jsx(U,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-bold uppercase",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-black text-purple-900",children:[c.totalRevenue.toFixed(0)," EGP"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-3 border border-indigo-200",children:[e.jsx("p",{className:"text-xs text-indigo-600 font-bold",children:"Processing"}),e.jsx("p",{className:"text-xl font-black text-indigo-900",children:c.processing})]}),e.jsxs("div",{className:"bg-red-50 rounded-xl p-3 border border-red-200",children:[e.jsx("p",{className:"text-xs text-red-600 font-bold",children:"Cancelled"}),e.jsx("p",{className:"text-xl font-black text-red-900",children:c.cancelled})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-3 border border-orange-200",children:[e.jsx("p",{className:"text-xs text-orange-600 font-bold",children:"Pending Payment"}),e.jsxs("p",{className:"text-xl font-black text-orange-900",children:[c.pendingRevenue.toFixed(0)," EGP"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(A,{className:"text-gray-600",size:20}),e.jsx("h2",{className:"text-lg font-black text-gray-900",children:"Filters & Search"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx(T,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search by Order ID, Customer name, or Email...",value:p,onChange:s=>z(s.target.value),className:"w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-900 focus:ring-4 focus:ring-primary-100 transition-all outline-none font-medium"})]}),e.jsxs("select",{value:m,onChange:s=>D(s.target.value),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-900 focus:ring-4 focus:ring-primary-100 outline-none font-bold text-gray-700",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:g,onChange:s=>O(s.target.value),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-900 focus:ring-4 focus:ring-primary-100 outline-none font-bold text-gray-700",children:[e.jsx("option",{value:"all",children:"All Payments"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"unpaid",children:"Unpaid"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-black text-gray-900",children:h.length})," of ",e.jsx("span",{className:"font-black",children:l.length})," orders"]}),e.jsxs("button",{onClick:u,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-xl font-bold text-sm transition-all",children:[e.jsx(W,{size:16})," Refresh"]})]})]}),S?e.jsx("div",{className:"bg-white rounded-2xl p-12 flex justify-center border border-gray-100",children:e.jsx(L,{size:"lg"})}):y?e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-2xl p-6 flex items-start gap-3",children:[e.jsx($,{className:"text-red-500 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Error Loading Orders"}),e.jsx("p",{className:"text-red-700 text-sm",children:y}),e.jsx("button",{onClick:u,className:"mt-3 px-4 py-2 bg-red-100 text-red-700 rounded-xl font-bold hover:bg-red-200 transition-all",children:"Retry"})]})]}):h.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(N,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("p",{className:"text-gray-500 font-medium",children:p||m!=="all"||g!=="all"?"No orders match your filters":"No orders found"})]}):e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Order ID"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Payment"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-gray-700 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-black text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(s=>{var a,r,i;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("code",{className:"bg-blue-50 text-blue-700 px-3 py-1.5 rounded-lg font-mono text-xs font-bold border border-blue-200",children:["#",s._id.slice(-8).toUpperCase()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-black text-gray-900 text-sm",children:((a=s.user)==null?void 0:a.name)||"Guest"}),e.jsx("div",{className:"text-xs text-gray-500",children:(r=s.user)==null?void 0:r.email})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 font-medium",children:new Date(s.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"font-black text-lg text-gray-900",children:[(i=s.totalPrice)==null?void 0:i.toFixed(0)," EGP"]})}),e.jsx("td",{className:"px-6 py-4",children:_(s.isPaid)}),e.jsx("td",{className:"px-6 py-4",children:E===s._id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{size:"sm"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Updating..."})]}):e.jsxs("select",{value:s.status||(s.isDelivered?"delivered":"processing"),onChange:d=>R(s._id,d.target.value),className:"px-4 py-2.5 font-bold border-3 rounded-xl outline-none transition-all cursor-pointer shadow-sm hover:shadow-md",style:{backgroundColor:(s.status||"").toLowerCase()==="pending"?"#fef3c7":(s.status||"").toLowerCase()==="processing"?"#dbeafe":(s.status||"").toLowerCase()==="confirmed"?"#e0e7ff":(s.status||"").toLowerCase()==="shipped"?"#f3e8ff":(s.status||"").toLowerCase()==="delivered"?"#d1fae5":(s.status||"").toLowerCase()==="cancelled"?"#fee2e2":"#f3f4f6",color:(s.status||"").toLowerCase()==="pending"?"#92400e":(s.status||"").toLowerCase()==="processing"?"#1e40af":(s.status||"").toLowerCase()==="confirmed"?"#4338ca":(s.status||"").toLowerCase()==="shipped"?"#7c3aed":(s.status||"").toLowerCase()==="delivered"?"#065f46":(s.status||"").toLowerCase()==="cancelled"?"#991b1b":"#374151",borderColor:(s.status||"").toLowerCase()==="pending"?"#fbbf24":(s.status||"").toLowerCase()==="processing"?"#3b82f6":(s.status||"").toLowerCase()==="confirmed"?"#6366f1":(s.status||"").toLowerCase()==="shipped"?"#a855f7":(s.status||"").toLowerCase()==="delivered"?"#10b981":(s.status||"").toLowerCase()==="cancelled"?"#ef4444":"#d1d5db"},onClick:d=>d.stopPropagation(),children:[e.jsx("option",{value:"pending",style:{backgroundColor:"#fef3c7",color:"#92400e",fontWeight:"bold",padding:"8px"},children:"‚è≥ Pending"}),e.jsx("option",{value:"processing",style:{backgroundColor:"#dbeafe",color:"#1e40af",fontWeight:"bold",padding:"8px"},children:"üîÑ Processing"}),e.jsx("option",{value:"confirmed",style:{backgroundColor:"#e0e7ff",color:"#4338ca",fontWeight:"bold",padding:"8px"},children:"‚úÖ Confirmed"}),e.jsx("option",{value:"shipped",style:{backgroundColor:"#f3e8ff",color:"#7c3aed",fontWeight:"bold",padding:"8px"},children:"üöö Shipped"}),e.jsx("option",{value:"delivered",style:{backgroundColor:"#d1fae5",color:"#065f46",fontWeight:"bold",padding:"8px"},children:"‚úì Delivered"}),e.jsx("option",{value:"cancelled",style:{backgroundColor:"#fee2e2",color:"#991b1b",fontWeight:"bold",padding:"8px"},children:"‚úï Cancelled"})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(G,{to:`/admin/orders/${s._id}`,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-50 text-primary-600 hover:bg-primary-100 rounded-xl font-bold text-sm transition-all border-2 border-primary-200 hover:border-primary-300 hover:shadow-md transform hover:scale-105",children:[e.jsx(M,{size:16})," View Details"]})})]},s._id)})})]})})})]})};export{H as default};
